<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
 * SESSION_INFO
 * ID							ID						BIGINT						PRIMARY KEY					AUTO_INCREMENT
 * 关联人ID						RELATION_USER_ID		VARCHAR(255)
 -->
<mapper namespace="com.hanslv.web.chat.mapper.SessionInfoMapper">
    <!-- 获取全部 -->
    <select id="selectAll" resultType="com.hanslv.web.chat.entity.SessionInfoEntity">
        SELECT * FROM SESSION_INFO;
    </select>

    <!-- 根据SessionKey查询会话 -->
    <select id="selectBySessionKey" resultType="com.hanslv.web.chat.entity.SessionInfoEntity">
        SELECT * FROM SESSION_INFO WHERE RELATION_USER_ID = #{sessionKeyA} OR RELATION_USER_ID = #{sessionKeyB};
    </select>

    <!-- 插入一条数据并返回ID -->
    <insert id="insertOne" parameterType="string">
        INSERT INTO SESSION_INFO (RELATION_USER_ID) VALUES (#{sessionKey});
        <selectKey resultType="int" order="AFTER" keyProperty="id">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>
</mapper>